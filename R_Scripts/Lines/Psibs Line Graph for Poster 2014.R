setwd("V:/3730Data/377STRs/Wildlife/R Scripts/R Stuff/Lines")
library(graphics)
library(splines)
library(car)
rm(list=ls())
par(mar=c(5,7,2,2))

Gray1 = rgb(0, 0, 0, 150, names = NULL, maxColorValue = 225)
Gray2 = rgb(225, 225, 225, 150, names = NULL, maxColorValue = 225)

line = read.table("PID.txt", header = TRUE)
attach(line)
#ispsib = interpSpline(line$Locus, line$PID)
#ispID = interpSpline(line$Locus, line$PSIBS)
#xvec <- seq(min(line$Locus),max(line$Locus),length=200)  
plot.new()
par(mar=c(7,7,2,2))
scatterplot(PID~Locus, xaxt="n",yaxt="n",ylab="",xlab="",smooth=FALSE,
boxplot = FALSE, grid = FALSE, reg.line=FALSE, ylim=c(0.001,0.4), xlim=c(0,10), pch=c(22), bg=c("blue"), col=c("black"), cex=0, legend.plot = FALSE)
#lines(predict(ispsib,xvec),col="firebrick1", lwd = 2, lty = 1, add = T)
#lines(predict(ispID,xvec),col="dodgerblue1", lwd = 2, lty = 1, add =T)
segments(7.5,-0.1,7.5,0.25, col="black",lty=1, lwd=2)
axis(1, at = c(0:10), labels=c(0:10), cex.axis = 2.5, tck=0.01)
axis(2, at = NULL,cex.axis = 2.5, tck=0.01)
mtext("No. matching loci", 1, cex = 3, line = 3.5)
mtext("Expected frequency", 2, cex = 3, line = 4)
#PID lines
segments(-0.5,PID[1],0.5,PID[1], col="gray75",lty="dotted", lwd=3)
segments(0.5,PID[1],0.5,PID[2], col="gray75",lty="dotted", lwd=3)
segments(0.5,PID[2],1.5,PID[2], col="gray75",lty="dotted", lwd=3)
segments(1.5,PID[2],1.5,PID[3], col="gray75",lty="dotted", lwd=3)
segments(1.5,PID[3],2.5,PID[3], col="gray75",lty="dotted", lwd=3)
segments(2.5,PID[3],2.5,PID[4], col="gray75",lty="dotted", lwd=3)
segments(2.5,PID[4],3.5,PID[4], col="gray75",lty="dotted", lwd=3)
segments(3.5,PID[4],3.5,PID[5], col="gray75",lty="dotted", lwd=3)
segments(3.5,PID[5],4.5,PID[5], col="gray75",lty="dotted", lwd=3)
segments(4.5,PID[5],4.5,PID[6], col="gray75",lty="dotted", lwd=3)
segments(4.5,PID[6],5.5,PID[6], col="gray75",lty="dotted", lwd=3)
segments(5.5,PID[6],5.5,PID[7], col="gray75",lty="dotted", lwd=3)
segments(5.5,PID[7],6.5,PID[7], col="gray75",lty="dotted", lwd=3)
segments(6.5,PID[7],6.5,PID[8], col="gray75",lty="dotted", lwd=3)
segments(6.5,PID[8],7.5,PID[8], col="gray75",lty="dotted", lwd=3)
segments(7.5,PID[8],7.5,PID[9], col="gray75",lty="dotted", lwd=3)
segments(7.5,PID[9],8.5,PID[9], col="gray75",lty="dotted", lwd=3)
segments(8.5,PID[9],8.5,PID[10], col="gray75",lty="dotted", lwd=3)
segments(8.5,PID[10],10,PID[10], col="gray75",lty="dotted", lwd=3)

#PSIBS lines
segments(-0.5,PSIBS[1],0.5,PSIBS[1], col="gray40",lty="dotted", lwd=3)
segments(0.5,PSIBS[1],0.5,PSIBS[2], col="gray40",lty="dotted", lwd=3)
segments(0.5,PSIBS[2],1.5,PSIBS[2], col="gray40",lty="dotted", lwd=3)
segments(1.5,PSIBS[2],1.5,PSIBS[3], col="gray40",lty="dotted", lwd=3)
segments(1.5,PSIBS[3],2.5,PSIBS[3], col="gray40",lty="dotted", lwd=3)
segments(2.5,PSIBS[3],2.5,PSIBS[4], col="gray40",lty="dotted", lwd=3)
segments(2.5,PSIBS[4],3.5,PSIBS[4], col="gray40",lty="dotted", lwd=3)
segments(3.5,PSIBS[4],3.5,PSIBS[5], col="gray40",lty="dotted", lwd=3)
segments(3.5,PSIBS[5],4.5,PSIBS[5], col="gray40",lty="dotted", lwd=3)
segments(4.5,PSIBS[5],4.5,PSIBS[6], col="gray40",lty="dotted", lwd=3)
segments(4.5,PSIBS[6],5.5,PSIBS[6], col="gray40",lty="dotted", lwd=3)
segments(5.5,PSIBS[6],5.5,PSIBS[7], col="gray40",lty="dotted", lwd=3)
segments(5.5,PSIBS[7],6.5,PSIBS[7], col="gray40",lty="dotted", lwd=3)
segments(6.5,PSIBS[7],6.5,PSIBS[8], col="gray40",lty="dotted", lwd=3)
segments(6.5,PSIBS[8],7.5,PSIBS[8], col="gray40",lty="dotted", lwd=3)
segments(7.5,PSIBS[8],7.5,PSIBS[9], col="gray40",lty="dotted", lwd=3)
segments(7.5,PSIBS[9],8.5,PSIBS[9], col="gray40",lty="dotted", lwd=3)
segments(8.5,PSIBS[9],8.5,PSIBS[10], col="gray40",lty="dotted", lwd=3)
segments(8.5,PSIBS[10],10,PSIBS[10], col="gray40",lty="dotted", lwd=3)

#Execute these twice! It's faster than learning how to fix the rbg alpha...
points(PSIBS~Locus, pch=c(21), bg=Gray1, col=c("black"), cex=3)
points(PID~Locus, pch=c(22), bg=Gray2, col=c("black"), cex=3)
legend(7.250, 0.380, legend=c("Random","Siblings"), pt.cex=c(4,4), cex=c(2.5,2.5), pch=c(22, 21), pt.bg=c(Gray2,Gray1), col=c("black"))


